<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SQE1 Criminal Law ‚Äî Chapter 1 Quiz (General Principles)</title>
  <style>
    :root {
      --bg: #0b0f19;
      --card: #121a2a;
      --muted: #8fa3bf;
      --text: #eaf0ff;
      --border: rgba(255,255,255,.10);
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --good: #32d583;
      --bad: #ff6b6b;
      --warn: #ffd166;
      --accent: #7aa2ff;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(1200px 600px at 20% 0%, rgba(122,162,255,.18), transparent 60%),
                  radial-gradient(900px 500px at 90% 10%, rgba(50,213,131,.14), transparent 55%),
                  var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 22px;
    }
    .wrap { width: min(980px, 100%); }
    header {
      display: flex;
      gap: 16px;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: 16px;
    }
    .title h1 {
      font-size: 20px;
      margin: 0 0 6px 0;
      letter-spacing: .2px;
    }
    .title p {
      margin: 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
    }
    .controls {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
      justify-content: flex-end;
    }
    button {
      appearance: none;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 8px 18px rgba(0,0,0,.18);
      transition: transform .08s ease, background .15s ease, border-color .15s ease;
      font-weight: 600;
      font-size: 13px;
    }
    button:hover { transform: translateY(-1px); border-color: rgba(255,255,255,.18); }
    button:active { transform: translateY(0px); }
    button.secondary { background: transparent; }
    button:disabled { opacity: .55; cursor: not-allowed; transform: none; }

    .card {
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid var(--border);
      border-radius: 18px;
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    .topbar {
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
      padding: 14px 16px;
      border-bottom: 1px solid var(--border);
    }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.05);
      color: var(--muted);
      font-size: 12px;
      font-weight: 600;
      white-space: nowrap;
    }
    .pill strong { color: var(--text); font-weight: 800; }
    .progress {
      flex: 1;
      height: 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.04);
      overflow: hidden;
      min-width: 140px;
      max-width: 420px;
    }
    .progress > div {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, rgba(122,162,255,.85), rgba(50,213,131,.85));
    }
    .content { padding: 16px; }
    .q-meta {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }
    .tag {
      font-size: 12px;
      color: var(--muted);
      border: 1px dashed rgba(255,255,255,.18);
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.02);
    }
    .question {
      font-size: 16px;
      line-height: 1.45;
      margin: 10px 0 14px 0;
    }
    .options {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    .opt {
      border: 1px solid var(--border);
      background: rgba(255,255,255,.04);
      border-radius: 14px;
      padding: 12px;
      cursor: pointer;
      transition: transform .06s ease, border-color .15s ease, background .15s ease;
      display: flex;
      gap: 10px;
      align-items: flex-start;
    }
    .opt:hover { transform: translateY(-1px); border-color: rgba(255,255,255,.18); }
    .opt:active { transform: translateY(0px); }
    .opt[aria-disabled="true"] { cursor: default; opacity: 1; }
    .letter {
      width: 26px;
      height: 26px;
      border-radius: 8px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.05);
      font-weight: 800;
      color: var(--muted);
      flex: 0 0 auto;
      margin-top: 1px;
    }
    .opt .txt { color: var(--text); line-height: 1.35; }
    .opt.correct {
      border-color: rgba(50,213,131,.7);
      background: rgba(50,213,131,.12);
    }
    .opt.wrong {
      border-color: rgba(255,107,107,.7);
      background: rgba(255,107,107,.12);
    }
    .feedback {
      margin-top: 14px;
      padding: 12px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.04);
      display: none;
    }
    .feedback.show { display: block; }
    .feedback .headline {
      font-weight: 900;
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .badge {
      font-size: 12px;
      font-weight: 900;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.04);
    }
    .badge.good { border-color: rgba(50,213,131,.7); color: var(--good); }
    .badge.bad { border-color: rgba(255,107,107,.7); color: var(--bad); }
    details {
      margin-top: 8px;
      border-top: 1px solid rgba(255,255,255,.10);
      padding-top: 10px;
    }
    summary {
      cursor: pointer;
      color: var(--accent);
      font-weight: 800;
      user-select: none;
    }
    .explain {
      margin-top: 10px;
      color: var(--text);
      line-height: 1.45;
      font-size: 13px;
    }
    .explain p { margin: 8px 0; }
    .nav {
      display: flex;
      gap: 10px;
      justify-content: space-between;
      margin-top: 16px;
      flex-wrap: wrap;
    }
    .muted { color: var(--muted); }
    .end {
      display: none;
      padding: 18px;
      text-align: center;
    }
    .end.show { display: block; }
    .end h2 { margin: 0 0 10px 0; font-size: 18px; }
    .end p { margin: 0 0 14px 0; color: var(--muted); }
    .scorebig {
      font-size: 44px;
      font-weight: 1000;
      letter-spacing: -1px;
      margin: 8px 0 14px 0;
    }
    .smallnote { font-size: 12px; color: var(--muted); margin-top: 10px; }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>SQE1 Criminal Law ‚Äî Chapter 1 Quiz</h1>
        <p>General principles (AR/MR, omissions, causation, coincidence, strict liability, burden/standard). Click an option to get instant feedback.</p>
      </div>
      <div class="controls">
        <button id="shuffleBtn" class="secondary" title="Shuffle questions and options">Shuffle</button>
        <button id="restartBtn" title="Restart the quiz">Restart</button>
      </div>
    </header>

    <div class="card" id="quizCard">
      <div class="topbar">
        <div class="pill"><strong id="qNum">1</strong>/<span id="qTotal">30</span></div>
        <div class="progress" aria-label="Progress"><div id="progFill"></div></div>
        <div class="pill">Score: <strong id="score">0</strong></div>
      </div>

      <div class="content" id="quizView">
        <div class="q-meta">
          <span class="tag" id="topicTag">Topic</span>
        </div>

        <div class="question" id="questionText">Question text</div>

        <div class="options" id="options"></div>

        <div class="feedback" id="feedbackBox">
          <div class="headline">
            <span id="fbBadge" class="badge">‚Äî</span>
            <span id="fbText">‚Äî</span>
          </div>

          <details id="explainDetails">
            <summary>Show explanation</summary>
            <div class="explain" id="explainBox"></div>
          </details>

          <div class="nav">
            <button id="prevBtn" class="secondary">‚Üê Previous</button>
            <button id="nextBtn">Next ‚Üí</button>
          </div>
        </div>
      </div>

      <div class="end" id="endView">
        <h2>Finished üéâ</h2>
        <div class="scorebig" id="finalScore">0/30</div>
        <p id="finalMsg">‚Äî</p>
        <button id="reviewBtn" class="secondary">Review answers</button>
        <button id="restartBtn2">Restart</button>
        <div class="smallnote">Tip: hit ‚ÄúShuffle‚Äù for a fresh run.</div>
      </div>
    </div>
  </div>

<script>
/**
 * SQE1 Criminal Law ‚Äî Chapter 1 (General Principles)
 * 30 MCQs with instant feedback + explanations and why others are wrong.
 *
 * NOTE: The correct answers are not displayed in the UI until you pick an option.
 * (They are still in the page source, as with any client-side quiz.)
 */

const originalQuestions = [
  {
    topic: "Actus reus ‚Äî voluntariness",
    q: "D has an epileptic seizure while driving, loses complete control, and hits V. D had no warning symptoms. Which is most accurate?",
    choices: [
      "D is liable because driving is always voluntary",
      "D is not liable because the act was involuntary",
      "D is liable if V‚Äôs injuries are serious",
      "D is liable because negligence is enough for all crimes"
    ],
    correct: 1,
    explain: {
      whyRight: "If D‚Äôs movements were involuntary (complete loss of control), there may be no actus reus. On these facts (no warning), the best answer is that D is not liable on the basis of voluntariness.",
      whyWrong: [
        "Driving is not 'always' voluntary if D loses all control involuntarily.",
        "‚Äî",
        "Serious injury does not replace the need for a voluntary actus reus.",
        "Negligence is not sufficient for all crimes; many require intention or recklessness."
      ]
    }
  },
  {
    topic: "Omissions ‚Äî duties",
    q: "D accidentally starts a small fire in his flat by dropping a lit cigarette on a mattress. He notices it and leaves without calling for help. Which duty best supports liability?",
    choices: ["Duty from contract", "Duty from special relationship", "Duty from creating a dangerous situation", "Duty from public office"],
    correct: 2,
    explain: {
      whyRight: "Where D creates a dangerous situation, he owes a duty to take reasonable steps to avert the danger (classic 'created danger' duty).",
      whyWrong: [
        "No contract facts are given.",
        "No special relationship is indicated.",
        "‚Äî",
        "No public office is involved."
      ]
    }
  },
  {
    topic: "Omissions ‚Äî duties",
    q: "D agrees to care for his ill aunt at home, then fails to provide food or medical assistance. Which basis is strongest?",
    choices: ["Duty by assumption of responsibility", "No duty because it‚Äôs an omission", "Duty only if paid", "Duty only if living together is legally required"],
    correct: 0,
    explain: {
      whyRight: "Voluntary assumption of responsibility can create a duty to act, making omissions capable of criminal liability.",
      whyWrong: [
        "‚Äî",
        "Omissions can be criminal where a recognised legal duty exists.",
        "Payment is not required for a duty to arise.",
        "No rule requires living together to be legally required."
      ]
    }
  },
  {
    topic: "Causation ‚Äî factual",
    q: "D poisons V intending to kill. Before the poison takes effect, V dies instantly in an unrelated earthquake. Is D a factual cause of death?",
    choices: [
      "Yes, because D intended death",
      "Yes, because D was an operating and substantial cause",
      "No, because ‚Äúbut for‚Äù D‚Äôs act V would still have died",
      "No, because causation requires intention"
    ],
    correct: 2,
    explain: {
      whyRight: "Factual causation uses the 'but for' test. Here, V would have died anyway at that moment due to the earthquake, so D is not a factual cause of death.",
      whyWrong: [
        "Intention does not establish factual causation.",
        "D‚Äôs act never operated to cause death here.",
        "‚Äî",
        "Causation does not require intention; it‚Äôs a separate element."
      ]
    }
  },
  {
    topic: "Causation ‚Äî thin skull",
    q: "D lightly assaults V, who has a rare condition meaning minor injuries cause fatal complications. V dies. Which statement is correct?",
    choices: [
      "D is not liable because death was unforeseeable",
      "D is liable; take victim as found",
      "D is liable only if he knew of the condition",
      "V‚Äôs condition breaks the chain of causation"
    ],
    correct: 1,
    explain: {
      whyRight: "Thin skull rule: D takes the victim as found. Unforeseeable severity does not break causation.",
      whyWrong: [
        "Unforeseeability of the extent does not negate causation under thin skull.",
        "‚Äî",
        "Knowledge of the condition is not required.",
        "Victim vulnerability generally does not break causation."
      ]
    }
  },
  {
    topic: "Causation ‚Äî intervening acts",
    q: "D stabs V. At hospital, V receives negligent treatment but dies. Which is most accurate?",
    choices: [
      "Medical negligence always breaks causation",
      "Causation breaks only if treatment is the sole cause of death and D‚Äôs act becomes insignificant",
      "Any negligence breaks causation if unforeseeable",
      "Causation never breaks once an injury is inflicted"
    ],
    correct: 1,
    explain: {
      whyRight: "Negligent medical treatment usually does not break the chain unless it is so independent and potent that D‚Äôs act becomes insignificant.",
      whyWrong: [
        "Too absolute: negligence does not always break causation.",
        "‚Äî",
        "Unforeseeability is not the decisive test here.",
        "Also too absolute: chains can break in rare, exceptional circumstances."
      ]
    }
  },
  {
    topic: "Causation ‚Äî victim acts",
    q: "D threatens V with minor violence. V jumps from a slow-moving car to escape and is injured. D argues V acted unreasonably. Best approach?",
    choices: [
      "Chain breaks if V‚Äôs reaction is ‚Äúdaft‚Äù",
      "Chain breaks if V‚Äôs reaction is foreseeable",
      "Chain never breaks with victim acts",
      "Chain breaks only if V intended to injure himself"
    ],
    correct: 0,
    explain: {
      whyRight: "Victim reactions can break causation only if so disproportionate/daft that they are not reasonably foreseeable.",
      whyWrong: [
        "‚Äî",
        "Foreseeability tends to preserve causation, not break it.",
        "Too absolute: victim acts can break causation in rare cases.",
        "Victim intent to self-injure is not required for novus actus."
      ]
    }
  },
  {
    topic: "Coincidence ‚Äî continuing act",
    q: "D drives onto V‚Äôs foot accidentally. V shouts. D then realises and keeps the car there to punish V. Liability for battery?",
    choices: [
      "No, because MR formed after AR",
      "Yes, because AR is a continuing act",
      "No, because battery requires injury",
      "Yes, but only if V‚Äôs foot breaks"
    ],
    correct: 1,
    explain: {
      whyRight: "Continuing act doctrine: once D forms the mens rea while the actus reus continues, coincidence can be satisfied.",
      whyWrong: [
        "Continuing act doctrine addresses this scenario.",
        "‚Äî",
        "Battery does not require injury; unlawful force is enough.",
        "Serious injury is not required for battery."
      ]
    }
  },
  {
    topic: "Coincidence ‚Äî transaction principle",
    q: "D attacks V, intending to kill. Thinking V is dead, D sets fire to conceal the ‚Äúbody‚Äù, and V dies from smoke inhalation. Best analysis?",
    choices: [
      "No murder because intention existed only during the first act",
      "Murder possible because acts form one transaction",
      "No liability because the fire is a new act",
      "Manslaughter only, because intention must be at the moment of death"
    ],
    correct: 1,
    explain: {
      whyRight: "Where there is a series of acts in one transaction with the relevant mens rea, courts can treat it as one continuous sequence for coincidence.",
      whyWrong: [
        "Too narrow: transaction principle can apply.",
        "‚Äî",
        "Not necessarily: the sequence can be treated as one transaction.",
        "Not required in that rigid way under transaction analysis."
      ]
    }
  },
  {
    topic: "Omissions ‚Äî contract duty",
    q: "A level crossing gatekeeper is paid to close the gate. He leaves it open and a person is killed by a train. Basis for duty?",
    choices: [
      "Statutory duty only",
      "Duty from contract",
      "Duty from creation of danger only",
      "No duty because omission"
    ],
    correct: 1,
    explain: {
      whyRight: "A contractual duty can found liability for an omission where the contract requires action and the omission causes harm.",
      whyWrong: [
        "A statutory duty is not required if a contractual duty exists.",
        "‚Äî",
        "Created danger not necessary on these facts.",
        "Incorrect where a legal duty exists."
      ]
    }
  },
  {
    topic: "Omissions ‚Äî public office duty",
    q: "A police officer witnesses a violent assault but deliberately does nothing, although able to intervene. Liability can arise from:",
    choices: [
      "Duty of special relationship",
      "Duty of public office",
      "Duty of contract (unless paid overtime)",
      "No duty in criminal law"
    ],
    correct: 1,
    explain: {
      whyRight: "Public officers can be liable for wilful neglect of duty where they deliberately fail to act.",
      whyWrong: [
        "Special relationship isn‚Äôt the key category here.",
        "‚Äî",
        "Overtime has nothing to do with the existence of the duty.",
        "Incorrect: duties can arise in recognised categories."
      ]
    }
  },
  {
    topic: "Causation ‚Äî legal",
    q: "D‚Äôs punch causes V to fall. V later dies due to complications to which the fall contributed. For legal causation, D‚Äôs act must be:",
    choices: [
      "The sole cause",
      "A more than minimal cause (operating and substantial)",
      "The last cause in time",
      "Foreseeable as the only possible cause"
    ],
    correct: 1,
    explain: {
      whyRight: "Legal causation: D‚Äôs act must be a significant contribution (more than minimal), typically described as operating and substantial.",
      whyWrong: [
        "Not required: there can be multiple causes.",
        "‚Äî",
        "Being last in time is not the test.",
        "Not required: causation doesn‚Äôt demand foreseeability as the only possible cause."
      ]
    }
  },
  {
    topic: "Causation ‚Äî intervening third party",
    q: "D wounds V. A stranger deliberately shoots V in hospital, killing him. Most accurate?",
    choices: [
      "D remains liable because he started the sequence",
      "The deliberate third-party act is likely a novus actus breaking causation",
      "Causation never breaks after a wound",
      "D is liable only if he foresaw a shooting"
    ],
    correct: 1,
    explain: {
      whyRight: "A free, deliberate, and informed act by a third party is typically an independent intervening cause that can break the chain.",
      whyWrong: [
        "Starting the sequence isn‚Äôt enough if the chain is broken by an independent act.",
        "‚Äî",
        "Too absolute: chains can break.",
        "Foreseeability isn‚Äôt the sole determinant; deliberate acts often break causation regardless."
      ]
    }
  },
  {
    topic: "Strict liability ‚Äî policy",
    q: "Which factor most strongly suggests Parliament intended strict liability for an offence element?",
    choices: [
      "Offence is truly serious with stigma and heavy imprisonment",
      "Offence is regulatory/public welfare with modest penalty",
      "The statute is silent on MR",
      "The offence is common law"
    ],
    correct: 1,
    explain: {
      whyRight: "Strict liability is more common in regulatory/public welfare offences, often with lower penalties and a focus on protection rather than stigma.",
      whyWrong: [
        "Serious/stigmatising offences usually push toward requiring MR.",
        "‚Äî",
        "Silence generally triggers a presumption of MR, not strict liability.",
        "Common law offences usually require MR."
      ]
    }
  },
  {
    topic: "Strict liability ‚Äî presumption",
    q: "A statute creates an offence but does not mention fault. What is the default judicial approach?",
    choices: [
      "Presume strict liability unless stated otherwise",
      "Presume mens rea is required unless clearly excluded",
      "Treat it as civil liability",
      "Require intention only (never recklessness)"
    ],
    correct: 1,
    explain: {
      whyRight: "There is a strong presumption that mens rea is required unless Parliament clearly indicates otherwise.",
      whyWrong: [
        "That reverses the presumption.",
        "‚Äî",
        "It remains a criminal offence.",
        "Mens rea can be recklessness depending on the offence; not intention-only."
      ]
    }
  },
  {
    topic: "Causation ‚Äî factual",
    q: "D negligently hits V with a car. V would have died the same day from an unrelated condition regardless. Factual causation?",
    choices: [
      "Yes, ‚Äúbut for‚Äù is satisfied",
      "No, because V would have died anyway",
      "Yes, because negligence is enough for causation",
      "No, because causation requires intention"
    ],
    correct: 1,
    explain: {
      whyRight: "If V would have died anyway at that time, the 'but for' test is not satisfied.",
      whyWrong: [
        "Incorrect: but-for fails if death would happen anyway at that time.",
        "‚Äî",
        "Negligence does not replace the but-for test.",
        "Causation does not require intention."
      ]
    }
  },
  {
    topic: "Omissions ‚Äî special relationship",
    q: "Which relationship most clearly creates a duty in criminal law?",
    choices: ["Close friends", "Parent to young child", "Neighbours", "Classmates"],
    correct: 1,
    explain: {
      whyRight: "Parent-child (or guardian-child) relationships are classic categories where duties are recognised.",
      whyWrong: [
        "Friendship does not automatically create a legal duty.",
        "‚Äî",
        "Neighbourhood proximity alone does not create a duty.",
        "Classmate status does not create a duty."
      ]
    }
  },
  {
    topic: "Omissions + coincidence",
    q: "D accidentally knocks V into a river. D then decides not to rescue V, hoping V will drown. Best analysis?",
    choices: [
      "No liability because drowning is an omission",
      "Liability possible because once D creates danger, duty to act arises",
      "No liability because intention formed after the act",
      "Liability only if D is a strong swimmer"
    ],
    correct: 1,
    explain: {
      whyRight: "Creating danger can generate a duty to take reasonable steps; failure to do so can be an actionable omission, and mens rea can coincide with the ongoing duty situation.",
      whyWrong: [
        "Omissions can be criminal where a duty exists.",
        "‚Äî",
        "Coincidence can be satisfied via continuing duty/continuing situation.",
        "Strength may affect what is reasonable, but duty does not depend on being a strong swimmer."
      ]
    }
  },
  {
    topic: "Causation ‚Äî thin skull (beliefs)",
    q: "D stabs V. Doctors could save V with a transfusion, but V refuses for religious reasons and dies. Causation?",
    choices: [
      "Chain breaks because refusal is unreasonable",
      "Chain breaks because refusal is unforeseeable",
      "Chain does not break; take victim as found",
      "Chain breaks only if doctors agree refusal is irrational"
    ],
    correct: 2,
    explain: {
      whyRight: "Thin skull applies: D takes the victim as found, including beliefs; refusal of treatment typically does not break causation.",
      whyWrong: [
        "Unreasonableness is not the test here.",
        "Foreseeability is not required in that way under thin skull reasoning.",
        "‚Äî",
        "Medical opinions on rationality do not determine legal causation here."
      ]
    }
  },
  {
    topic: "AR/MR basics",
    q: "Which best describes actus reus?",
    choices: ["The guilty mind", "The external elements of the offence", "The defendant‚Äôs motive", "The reasonableness of the defendant‚Äôs behaviour"],
    correct: 1,
    explain: {
      whyRight: "Actus reus is the external element(s): conduct, circumstances, and sometimes result.",
      whyWrong: [
        "That describes mens rea.",
        "‚Äî",
        "Motive is different from mens rea and not the actus reus.",
        "Reasonableness is not a general definition of actus reus."
      ]
    }
  },
  {
    topic: "MR and motive",
    q: "D steals money to pay for a child‚Äôs urgent medical treatment. Which is correct?",
    choices: [
      "Good motive prevents MR",
      "Motive may be relevant to sentencing, not whether theft MR is present",
      "Motive negates dishonesty",
      "Motive makes it a civil matter"
    ],
    correct: 1,
    explain: {
      whyRight: "Motive usually does not negate mens rea; it may be relevant to sentencing/mitigation.",
      whyWrong: [
        "Motive does not automatically prevent mens rea.",
        "‚Äî",
        "A good motive does not automatically negate dishonesty.",
        "It remains criminal, not civil."
      ]
    }
  },
  {
    topic: "Burden/standard ‚Äî elements",
    q: "In criminal trials, the prosecution generally must prove the elements of the offence:",
    choices: ["On balance of probabilities", "Beyond reasonable doubt", "To a prima facie standard only", "With absolute certainty"],
    correct: 1,
    explain: {
      whyRight: "Criminal standard is beyond reasonable doubt (often phrased as 'so that you are sure').",
      whyWrong: [
        "This is the civil standard.",
        "‚Äî",
        "Prima facie is not enough for conviction.",
        "Absolute certainty is not required."
      ]
    }
  },
  {
    topic: "Burden/standard ‚Äî defences",
    q: "D raises self-defence with some supporting evidence. Who must ultimately disprove self-defence (usually)?",
    choices: [
      "D, beyond reasonable doubt",
      "D, on balance of probabilities",
      "Prosecution, beyond reasonable doubt",
      "Judge, on balance of probabilities"
    ],
    correct: 2,
    explain: {
      whyRight: "Typically the defendant has an evidential burden; once raised, the prosecution must disprove beyond reasonable doubt.",
      whyWrong: [
        "Defendant usually does not carry this burden for self-defence.",
        "Defendant usually does not carry a legal burden for self-defence.",
        "‚Äî",
        "Judges do not bear the burden."
      ]
    }
  },
  {
    topic: "Burden/standard ‚Äî exception",
    q: "Which defence commonly places a legal burden on the defendant?",
    choices: ["Self-defence", "Insanity", "Mistake", "Alibi"],
    correct: 1,
    explain: {
      whyRight: "Insanity traditionally places a legal burden on the defendant (balance of probabilities).",
      whyWrong: [
        "Self-defence is usually for the prosecution to disprove once raised.",
        "‚Äî",
        "Mistake is typically part of evidential issues; prosecution disproves relevant points.",
        "Alibi is a factual contention; prosecution must still prove guilt."
      ]
    }
  },
  {
    topic: "Omissions ‚Äî created danger",
    q: "D creates a small fire accidentally. What is the duty?",
    choices: ["To guarantee no harm occurs", "To take reasonable steps to avert the danger", "To confess immediately", "No duty because it was accidental"],
    correct: 1,
    explain: {
      whyRight: "Duty is to take reasonable steps once D becomes aware of the danger created.",
      whyWrong: [
        "No strict guarantee of outcome is imposed.",
        "‚Äî",
        "Confession is not the legal duty here.",
        "Accidental creation can still trigger a duty once aware."
      ]
    }
  },
  {
    topic: "Causation ‚Äî timing",
    q: "D inflicts a serious wound. V dies weeks later after complications. Which is correct?",
    choices: [
      "Time lapse automatically breaks causation",
      "Time lapse is irrelevant; focus is on operating and substantial cause",
      "D cannot be liable unless death is immediate",
      "D is liable only if he intended death at the time of death"
    ],
    correct: 1,
    explain: {
      whyRight: "Time lapse does not automatically break causation; the key is whether D‚Äôs act remains a substantial contribution.",
      whyWrong: [
        "Time alone doesn‚Äôt break the chain.",
        "‚Äî",
        "Immediate death is not required.",
        "Mens rea timing is handled via coincidence doctrines; not in that rigid form."
      ]
    }
  },
  {
    topic: "Omissions ‚Äî continuing situation",
    q: "D accidentally knocks over a lamp, starting a fire. He notices smoke but goes to bed. Most accurate?",
    choices: [
      "No AR because starting the fire was accidental",
      "AR can include the omission to act once duty arises",
      "MR is irrelevant because fire is strict liability",
      "Duty arises only if D owns the property"
    ],
    correct: 1,
    explain: {
      whyRight: "Once aware of the danger he created, D‚Äôs omission to take reasonable steps can form part of the actus reus.",
      whyWrong: [
        "Accident doesn‚Äôt prevent later omission liability.",
        "‚Äî",
        "No general strict liability rule applies here.",
        "Ownership is not required for the duty to arise."
      ]
    }
  },
  {
    topic: "Causation ‚Äî victim acts",
    q: "D makes a mild threat from a distance. V, in panic, jumps from a high bridge and is injured. Best statement?",
    choices: [
      "Causation always remains because D threatened V",
      "Causation may break if V‚Äôs reaction is so disproportionate it‚Äôs unforeseeable/daft",
      "Causation breaks whenever V chooses to flee",
      "Causation depends only on whether D intended injury"
    ],
    correct: 1,
    explain: {
      whyRight: "Victim reactions can break the chain if they are so disproportionate that they are not reasonably foreseeable.",
      whyWrong: [
        "Too absolute; chains can break in exceptional victim reaction cases.",
        "‚Äî",
        "Not whenever; depends on foreseeability/proportionality.",
        "Intention does not control causation analysis."
      ]
    }
  },
  {
    topic: "Strict liability ‚Äî mistake",
    q: "D sells alcohol to a minor under a strict liability offence as to age. D genuinely believed the buyer was 18. Which is most accurate?",
    choices: [
      "Genuine belief always provides a defence",
      "If strict liability as to age, MR (and mistake) may be irrelevant to that element",
      "Mistake always breaks actus reus",
      "D is not liable because he lacked intention"
    ],
    correct: 1,
    explain: {
      whyRight: "If the age element is strict liability, an honest mistake about age may not help (depending on statutory construction).",
      whyWrong: [
        "Not always; strict liability may defeat mistake.",
        "‚Äî",
        "Mistake doesn‚Äôt 'break actus reus' as a rule.",
        "Intention may not be required for strict liability elements."
      ]
    }
  },
  {
    topic: "Causation ‚Äî when it matters",
    q: "Which scenario most clearly requires causation analysis?",
    choices: [
      "D lies to V about his age",
      "D punches V; V later dies after complications linked to the punch",
      "D merely possesses an illegal item",
      "D attempts but fails to pickpocket"
    ],
    correct: 1,
    explain: {
      whyRight: "Result crimes (e.g., death) require causation analysis (factual + legal causation).",
      whyWrong: [
        "Not necessarily a result crime requiring causation.",
        "‚Äî",
        "Possession offences are typically conduct/circumstance based.",
        "Attempts do not require the completed result."
      ]
    }
  },

  // --- 9 extra (to reach 30) in the same Chapter-1 scope ---
  {
    topic: "Coincidence ‚Äî general rule",
    q: "Which statement best reflects the general rule on coincidence?",
    choices: [
      "AR and MR must never coincide",
      "AR and MR must coincide, subject to doctrines like continuing act/transaction",
      "Coincidence applies only to homicide",
      "Coincidence applies only to strict liability offences"
    ],
    correct: 1,
    explain: {
      whyRight: "General rule: AR and MR coincide, with recognised solutions like continuing act and transaction principles.",
      whyWrong: [
        "Incorrect: they generally must coincide.",
        "‚Äî",
        "Coincidence is a general principle across offences.",
        "Strict liability is different; coincidence still matters where MR exists."
      ]
    }
  },
  {
    topic: "Omissions ‚Äî general rule",
    q: "What is the default position on omissions in criminal law?",
    choices: [
      "Omissions are always criminal",
      "Omissions are never criminal",
      "Omissions are generally not criminal unless a legal duty to act exists",
      "Omissions are criminal only if the defendant is morally at fault"
    ],
    correct: 2,
    explain: {
      whyRight: "General rule: no liability for omissions unless a recognised legal duty exists.",
      whyWrong: [
        "Too absolute.",
        "Too absolute.",
        "‚Äî",
        "Moral fault is not the test; legal duty is."
      ]
    }
  },
  {
    topic: "Causation ‚Äî legal threshold",
    q: "For legal causation in a result crime, D‚Äôs contribution must be:",
    choices: [
      "Trivial is enough",
      "More than minimal (a significant contribution)",
      "Exactly 50% of the cause",
      "The immediate cause only"
    ],
    correct: 1,
    explain: {
      whyRight: "Legal causation requires more than a minimal contribution (operating/substantial).",
      whyWrong: [
        "Trivial is not enough.",
        "‚Äî",
        "No 50% requirement exists.",
        "Not limited to immediate cause only."
      ]
    }
  },
  {
    topic: "Causation ‚Äî chain breaking",
    q: "Which is most likely to break the chain of causation?",
    choices: [
      "Normal medical treatment complications",
      "Victim‚Äôs foreseeable escape attempt",
      "A free, deliberate, informed act by a third party that becomes the direct cause of death",
      "Victim‚Äôs unusual vulnerability"
    ],
    correct: 2,
    explain: {
      whyRight: "A free, deliberate, informed third-party act is a classic candidate for novus actus interveniens.",
      whyWrong: [
        "Usually does not break the chain.",
        "Foreseeable reactions usually do not break the chain.",
        "‚Äî",
        "Thin skull: vulnerability doesn‚Äôt break causation."
      ]
    }
  },
  {
    topic: "Mens rea ‚Äî recklessness",
    q: "Which best fits modern subjective recklessness?",
    choices: [
      "D fails to think about a risk that a reasonable person would have foreseen",
      "D foresees a risk and unreasonably goes on to take it",
      "D intends the risk to occur",
      "D is careless and that is always enough"
    ],
    correct: 1,
    explain: {
      whyRight: "Subjective recklessness: foresight of risk + unreasonable taking of that risk.",
      whyWrong: [
        "That describes objective negligence-type reasoning, not modern subjective recklessness.",
        "‚Äî",
        "Intention is different from recklessness.",
        "Carelessness alone is not always enough (depends on offence)."
      ]
    }
  },
  {
    topic: "Mens rea ‚Äî intention (oblique)",
    q: "Oblique intention is most closely associated with which idea?",
    choices: [
      "Result is a virtually certain consequence and D appreciates that",
      "Result is merely possible and D doesn‚Äôt care",
      "Result is unforeseeable but happens anyway",
      "Result is morally blameworthy"
    ],
    correct: 0,
    explain: {
      whyRight: "Oblique intention: virtual certainty + appreciation of that certainty.",
      whyWrong: [
        "‚Äî",
        "That describes recklessness at most.",
        "Unforeseeability is not intention.",
        "Moral blameworthiness isn‚Äôt the legal test."
      ]
    }
  },
  {
    topic: "Burden ‚Äî evidential vs legal",
    q: "What does an evidential burden on the defendant usually mean?",
    choices: [
      "D must prove the defence beyond reasonable doubt",
      "D must raise some evidence capable of supporting the defence",
      "D must persuade the jury on balance of probabilities",
      "D must testify"
    ],
    correct: 1,
    explain: {
      whyRight: "Evidential burden: produce sufficient evidence to put the defence in issue; prosecution then must disprove (usually).",
      whyWrong: [
        "That‚Äôs not what evidential burden means.",
        "‚Äî",
        "That‚Äôs a legal burden standard, not evidential.",
        "D is not always required to testify."
      ]
    }
  },
  {
    topic: "Strict liability ‚Äî effect",
    q: "If an offence is strict liability as to a particular element, the consequence is:",
    choices: [
      "Prosecution must still prove intention for that element",
      "Defendant‚Äôs honest mistake about that element may not provide a defence",
      "Defendant is never liable if they took reasonable care",
      "The offence becomes civil"
    ],
    correct: 1,
    explain: {
      whyRight: "Strict liability means no mens rea is required for that element; honest mistake may be irrelevant unless statute provides otherwise.",
      whyWrong: [
        "Strict liability removes the need for MR for that element.",
        "‚Äî",
        "Reasonable care is not always a defence in strict liability.",
        "It remains criminal."
      ]
    }
  },
  {
    topic: "Voluntariness ‚Äî general principle",
    q: "Why does criminal law generally require voluntariness?",
    choices: [
      "Because punishment is only for morally bad people",
      "Because actus reus usually requires a voluntary act (control over conduct)",
      "Because mens rea is never required",
      "Because omissions are always excluded"
    ],
    correct: 1,
    explain: {
      whyRight: "Voluntariness supports the requirement that the actus reus is a product of D‚Äôs controlled conduct.",
      whyWrong: [
        "Moral judgment is not the legal test.",
        "‚Äî",
        "Mens rea is often required; this is unrelated.",
        "Omissions can be included when a duty exists."
      ]
    }
  }
];

// -------- quiz engine --------
let questions = [];
let state = {
  idx: 0,
  score: 0,
  answered: new Array(30).fill(false),
  picked: new Array(30).fill(null),
  orderMap: [] // per question: mapping from displayed option index -> original option index
};

const el = (id) => document.getElementById(id);

const qNum = el("qNum");
const qTotal = el("qTotal");
const scoreEl = el("score");
const progFill = el("progFill");
const topicTag = el("topicTag");
const questionText = el("questionText");
const optionsEl = el("options");
const feedbackBox = el("feedbackBox");
const fbBadge = el("fbBadge");
const fbText = el("fbText");
const explainBox = el("explainBox");
const explainDetails = el("explainDetails");
const prevBtn = el("prevBtn");
const nextBtn = el("nextBtn");
const shuffleBtn = el("shuffleBtn");
const restartBtn = el("restartBtn");
const quizView = el("quizView");
const endView = el("endView");
const finalScore = el("finalScore");
const finalMsg = el("finalMsg");
const reviewBtn = el("reviewBtn");
const restartBtn2 = el("restartBtn2");

qTotal.textContent = originalQuestions.length;

function deepCopy(obj) {
  return JSON.parse(JSON.stringify(obj));
}

function shuffleArray(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

function resetState() {
  state.idx = 0;
  state.score = 0;
  state.answered = new Array(originalQuestions.length).fill(false);
  state.picked = new Array(originalQuestions.length).fill(null);
  state.orderMap = new Array(originalQuestions.length).fill(null);
  scoreEl.textContent = "0";
}

function buildQuestions({ shuffleQuestions = false } = {}) {
  questions = deepCopy(originalQuestions);
  if (shuffleQuestions) shuffleArray(questions);

  // Reset order maps because question order may change
  resetState();
  render();
}

function setProgress() {
  const pct = ((state.idx) / (questions.length)) * 100;
  progFill.style.width = `${pct}%`;
  qNum.textContent = String(state.idx + 1);
  scoreEl.textContent = String(state.score);
}

function letters(i) {
  return String.fromCharCode("A".charCodeAt(0) + i);
}

function render() {
  setProgress();

  // End view?
  if (state.idx >= questions.length) {
    quizView.style.display = "none";
    endView.classList.add("show");
    finalScore.textContent = `${state.score}/${questions.length}`;
    const pct = Math.round((state.score / questions.length) * 100);
    finalMsg.textContent =
      pct >= 85 ? `Excellent. You're at ${pct}%. Move to the next chapter.` :
      pct >= 70 ? `Solid. You're at ${pct}%. Review explanations and retry shuffled.` :
      pct >= 50 ? `Getting there. You're at ${pct}%. Re-run and focus weak topics.` :
                  `You're at ${pct}%. Re-study the summary, then re-run.`;
    progFill.style.width = "100%";
    return;
  } else {
    quizView.style.display = "block";
    endView.classList.remove("show");
  }

  const item = questions[state.idx];

  topicTag.textContent = item.topic;
  questionText.textContent = item.q;

  // Build display order for options if not already set
  if (!state.orderMap[state.idx]) {
    const indices = item.choices.map((_, i) => i);
    shuffleArray(indices); // shuffle options each time question is first seen
    state.orderMap[state.idx] = indices;
  }

  const displayIndices = state.orderMap[state.idx];
  optionsEl.innerHTML = "";
  feedbackBox.classList.toggle("show", state.answered[state.idx]);

  // Reset explanation dropdown closed each render
  explainDetails.open = false;

  displayIndices.forEach((origIndex, displayIndex) => {
    const opt = document.createElement("div");
    opt.className = "opt";
    opt.setAttribute("role", "button");
    opt.tabIndex = 0;

    const letter = document.createElement("div");
    letter.className = "letter";
    letter.textContent = letters(displayIndex);

    const txt = document.createElement("div");
    txt.className = "txt";
    txt.textContent = item.choices[origIndex];

    opt.appendChild(letter);
    opt.appendChild(txt);

    // If already answered, mark correct/wrong choices and disable clicking
    if (state.answered[state.idx]) {
      opt.setAttribute("aria-disabled", "true");
      const chosenOrig = state.picked[state.idx];
      const isCorrect = (origIndex === item.correct);
      const isChosen = (origIndex === chosenOrig);

      if (isCorrect) opt.classList.add("correct");
      if (isChosen && !isCorrect) opt.classList.add("wrong");
    } else {
      opt.addEventListener("click", () => pick(displayIndex));
      opt.addEventListener("keydown", (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          pick(displayIndex);
        }
      });
    }

    optionsEl.appendChild(opt);
  });

  // Nav buttons
  prevBtn.disabled = (state.idx === 0);
  nextBtn.textContent = state.idx === questions.length - 1 ? "Finish ‚Üí" : "Next ‚Üí";

  if (state.answered[state.idx]) {
    showFeedback();
  }
}

function showFeedback() {
  const item = questions[state.idx];
  const chosenOrig = state.picked[state.idx];
  const isCorrect = (chosenOrig === item.correct);

  feedbackBox.classList.add("show");

  fbBadge.className = "badge " + (isCorrect ? "good" : "bad");
  fbBadge.textContent = isCorrect ? "Correct" : "Incorrect";
  fbText.textContent = isCorrect
    ? "Nice ‚Äî that‚Äôs the best answer."
    : "Not quite ‚Äî review the explanation and try again on restart/shuffle.";

  // Explanation content: include why right + why others wrong (excluding the correct one for 'why wrong')
  const explainHtml = [];
  explainHtml.push(`<p><strong>Why this is right:</strong> ${escapeHtml(item.explain.whyRight)}</p>`);

  // Build why-other-options-wrong list in DISPLAY order for clarity
  const displayIndices = state.orderMap[state.idx];
  const wrongLines = [];
  displayIndices.forEach((origIndex, displayIndex) => {
    if (origIndex === item.correct) return;
    const text = item.choices[origIndex];
    const reason = item.explain.whyWrong[origIndex] || "Not the best statement on these facts.";
    wrongLines.push(`<p><strong>${letters(displayIndex)}.</strong> ${escapeHtml(text)}<br><span class="muted">${escapeHtml(reason)}</span></p>`);
  });

  explainHtml.push(`<p><strong>Why the other options are wrong:</strong></p>`);
  explainHtml.push(wrongLines.join(""));

  explainBox.innerHTML = explainHtml.join("");
}

function escapeHtml(s) {
  return String(s)
    .replaceAll("&", "&amp;")
    .replaceAll("<", "&lt;")
    .replaceAll(">", "&gt;")
    .replaceAll('"', "&quot;")
    .replaceAll("'", "&#039;");
}

function pick(displayIndex) {
  const item = questions[state.idx];
  const origIndex = state.orderMap[state.idx][displayIndex];

  if (state.answered[state.idx]) return;

  state.answered[state.idx] = true;
  state.picked[state.idx] = origIndex;

  if (origIndex === item.correct) state.score += 1;

  render();
}

function go(delta) {
  const next = state.idx + delta;
  if (next < 0) return;

  // If going forward past last question, show end screen
  if (next >= questions.length) {
    state.idx = questions.length;
    render();
    return;
  }

  state.idx = next;
  render();
}

// Events
prevBtn.addEventListener("click", () => go(-1));
nextBtn.addEventListener("click", () => go(+1));

shuffleBtn.addEventListener("click", () => {
  buildQuestions({ shuffleQuestions: true });
});

restartBtn.addEventListener("click", () => {
  buildQuestions({ shuffleQuestions: false });
});
restartBtn2.addEventListener("click", () => {
  buildQuestions({ shuffleQuestions: false });
});
reviewBtn.addEventListener("click", () => {
  // jump back to first question and allow review (answers remain recorded)
  state.idx = 0;
  render();
});

// Keyboard shortcuts
document.addEventListener("keydown", (e) => {
  if (e.target && ["INPUT","TEXTAREA"].includes(e.target.tagName)) return;
  if (e.key === "ArrowLeft") go(-1);
  if (e.key === "ArrowRight") go(+1);
});

// Init
buildQuestions({ shuffleQuestions: false });
</script>
</body>
</html>
